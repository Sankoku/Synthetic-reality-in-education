<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR –í—ñ–∑–∏—Ç—ñ–≤–∫–∞ - –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞</title>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.1.4/dist/mindar-image-three.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
        }
        canvas {
            display: block;
        }
        #mindar-container {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #instructions {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 5px;
            font-size: 14px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="instructions">–ù–∞–≤–µ–¥—ñ—Ç—å –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä —Ç–∞ –Ω–∞—Ç–∏—Å–∫–∞–π—Ç–µ –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç–∏</div>

    <script>
        // –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É—Ä
        const createTextTexture = (text, fontSize = 64, color = '#ffffff', bgColor = '#000000') => {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 1024;
            canvas.height = 512;
            
            // –§–æ–Ω
            context.fillStyle = bgColor;
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            // –¢–µ–∫—Å—Ç
            context.fillStyle = color;
            context.font = `${fontSize}px Arial`;
            context.textAlign = 'center';
            context.textBaseline = 'middle';
            
            // –†–æ–∑–±–∏–≤–∞—î–º–æ —Ç–µ–∫—Å—Ç –Ω–∞ —Ä—è–¥–∫–∏
            const words = text.split(' ');
            const lines = [];
            let currentLine = words[0];
            
            for (let i = 1; i < words.length; i++) {
                const word = words[i];
                const width = context.measureText(currentLine + " " + word).width;
                if (width < canvas.width - 100) {
                    currentLine += " " + word;
                } else {
                    lines.push(currentLine);
                    currentLine = word;
                }
            }
            lines.push(currentLine);
            
            // –ú–∞–ª—é—î–º–æ —Ä—è–¥–∫–∏
            const lineHeight = fontSize * 1.2;
            const startY = canvas.height / 2 - (lines.length - 1) * lineHeight / 2;
            
            lines.forEach((line, index) => {
                context.fillText(line, canvas.width / 2, startY + index * lineHeight);
            });
            
            return new THREE.CanvasTexture(canvas);
        };

        document.addEventListener("DOMContentLoaded", async () => {
            const mindarThree = new window.MINDAR.IMAGE.MindARThree({
                container: document.body,
                imageTargetSrc: "./marker.mind",
            });

            const { renderer, scene, camera } = mindarThree;

            // –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É —Ç—ñ–Ω–µ–π
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;

            const anchor = mindarThree.addAnchor(0);
            const group = new THREE.Group();
            group.scale.set(0.25, 0.25, 0.25); // –ó–º–µ–Ω—à–µ–Ω–æ —É 2 —Ä–∞–∑–∏ –∑ 0.5 –¥–æ 0.25
            anchor.group.add(group);

            // –û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è  
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 15, 10);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);

            // –°—Ç–≤–æ—Ä—é—î–º–æ –æ—Å–Ω–æ–≤–Ω—É –≤—ñ–∑–∏—Ç—ñ–≤–∫—É
            const cardGeometry = new THREE.PlaneGeometry(4, 2.4);
            const cardTexture = createTextTexture('–õ—è—à–µ–Ω–∫–æ –†–æ–º–∞–Ω\nWeb Developer & AR Specialist', 48, '#ffffff', '#1a1a2e');
            const cardMaterial = new THREE.MeshStandardMaterial({ 
                map: cardTexture,
                transparent: true
            });
            const businessCard = new THREE.Mesh(cardGeometry, cardMaterial);
            businessCard.position.set(0, 0, 0);
            businessCard.castShadow = true;
            businessCard.receiveShadow = true;
            group.add(businessCard);

            // –°—Ç–≤–æ—Ä—é—î–º–æ —ñ–∫–æ–Ω–∫–∏ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂
            const iconGeometry = new THREE.CircleGeometry(0.3, 32);
            
            // –Ü–∫–æ–Ω–∫–∞ email
            const emailTexture = createTextTexture('üìß', 120, '#ff6b6b', '#ffffff');
            const emailMaterial = new THREE.MeshStandardMaterial({ 
                map: emailTexture,
                transparent: true
            });
            const emailIcon = new THREE.Mesh(iconGeometry, emailMaterial);
            emailIcon.position.set(-1.6, -1.6, 0.1);
            emailIcon.userData.clickable = true;
            emailIcon.userData.type = 'email';
            emailIcon.castShadow = true;
            group.add(emailIcon);

            // –Ü–∫–æ–Ω–∫–∞ –≤–µ–±-—Å–∞–π—Ç—É
            const webTexture = createTextTexture('üåê', 120, '#4ecdc4', '#ffffff');
            const webMaterial = new THREE.MeshStandardMaterial({ 
                map: webTexture,
                transparent: true
            });
            const webIcon = new THREE.Mesh(iconGeometry, webMaterial);
            webIcon.position.set(-0.6, -1.6, 0.1);
            webIcon.userData.clickable = true;
            webIcon.userData.type = 'web';
            webIcon.castShadow = true;
            group.add(webIcon);

            // –Ü–∫–æ–Ω–∫–∞ GitHub
            const githubTexture = createTextTexture('üíª', 120, '#333333', '#ffffff');
            const githubMaterial = new THREE.MeshStandardMaterial({ 
                map: githubTexture,
                transparent: true
            });
            const githubIcon = new THREE.Mesh(iconGeometry, githubMaterial);
            githubIcon.position.set(0.6, -1.6, 0.1);
            githubIcon.userData.clickable = true;
            githubIcon.userData.type = 'github';
            githubIcon.castShadow = true;
            group.add(githubIcon);

            // –Ü–∫–æ–Ω–∫–∞ LinkedIn
            const linkedinTexture = createTextTexture('üëî', 120, '#0077b5', '#ffffff');
            const linkedinMaterial = new THREE.MeshStandardMaterial({ 
                map: linkedinTexture,
                transparent: true
            });
            const linkedinIcon = new THREE.Mesh(iconGeometry, linkedinMaterial);
            linkedinIcon.position.set(1.6, -1.6, 0.1);
            linkedinIcon.userData.clickable = true;
            linkedinIcon.userData.type = 'linkedin';
            linkedinIcon.castShadow = true;
            group.add(linkedinIcon);

            // –°—Ç–≤–æ—Ä—é—î–º–æ 3D –∞–≤–∞—Ç–∞—Ä –∑ —Ç–µ–∫—Å—Ç—É—Ä–æ—é KDPU
            const avatarGeometry = new THREE.BoxGeometry(1, 1, 1);
            
            // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç–µ–∫—Å—Ç—É—Ä—É KDPU.png
            const textureLoader = new THREE.TextureLoader();
            const kdpuTexture = textureLoader.load('./KDPU.png', 
                // onLoad
                () => {
                    console.log('KDPU —Ç–µ–∫—Å—Ç—É—Ä–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ');
                },
                // onProgress
                undefined,
                // onError
                (err) => {
                    console.log('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è KDPU —Ç–µ–∫—Å—Ç—É—Ä–∏:', err);
                    // –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ä–µ–∑–µ—Ä–≤–Ω—É —Ç–µ–∫—Å—Ç—É—Ä—É
                    avatar.material.map = createTextTexture('LR', 200, '#ffffff', '#e74c3c');
                    avatar.material.needsUpdate = true;
                }
            );
            
            const avatarMaterial = new THREE.MeshStandardMaterial({ 
                map: kdpuTexture
            });
            const avatar = new THREE.Mesh(avatarGeometry, avatarMaterial);
            avatar.position.set(-2.4, 0.6, 0.4);
            avatar.userData.clickable = true;
            avatar.userData.type = 'avatar';
            avatar.castShadow = true;
            group.add(avatar);

            // –°—Ç–≤–æ—Ä—é—î–º–æ –ø–æ—Ä—Ç—Ñ–æ–ª—ñ–æ —Å–ª–∞–π–¥–∏
            const portfolioItems = [];
            const portfolioTextures = [
                createTextTexture('–ü—Ä–æ–µ–∫—Ç 1:\n–í–µ–±-–¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è\n–∫–µ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è–º–∏', 36, '#ffffff', '#9b59b6'),
                createTextTexture('–ü—Ä–æ–µ–∫—Ç 2:\n–ú–æ–±—ñ–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫\n–¥–ª—è AR –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó', 36, '#ffffff', '#e67e22'),
                createTextTexture('–ü—Ä–æ–µ–∫—Ç 3:\nE-commerce –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞\n–∑ AI —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è–º–∏', 36, '#ffffff', '#27ae60')
            ];

            portfolioTextures.forEach((texture, index) => {
                const portfolioGeometry = new THREE.PlaneGeometry(3, 2);
                const portfolioMaterial = new THREE.MeshStandardMaterial({ 
                    map: texture,
                    transparent: true
                });
                const portfolioItem = new THREE.Mesh(portfolioGeometry, portfolioMaterial);
                portfolioItem.position.set(2.4, 0.4, 0.1);
                portfolioItem.userData.clickable = true;
                portfolioItem.userData.type = 'portfolio';
                portfolioItem.userData.index = index;
                portfolioItem.castShadow = true;
                portfolioItems.push(portfolioItem);
            });

            let currentPortfolio = 0;
            group.add(portfolioItems[currentPortfolio]);

            // –ù–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω—ñ —Å—Ç—Ä—ñ–ª–∫–∏ –¥–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª—ñ–æ
            const arrowGeometry = new THREE.ConeGeometry(0.2, 0.4, 3);
            
            const leftArrow = new THREE.Mesh(arrowGeometry, new THREE.MeshStandardMaterial({ color: 0x3498db }));
            leftArrow.position.set(0.6, 0.4, 0.4);
            leftArrow.rotation.z = Math.PI / 2;
            leftArrow.userData.clickable = true;
            leftArrow.userData.type = 'leftArrow';
            leftArrow.castShadow = true;
            group.add(leftArrow);

            const rightArrow = new THREE.Mesh(arrowGeometry, new THREE.MeshStandardMaterial({ color: 0x3498db }));
            rightArrow.position.set(4.2, 0.4, 0.4);
            rightArrow.rotation.z = -Math.PI / 2;
            rightArrow.userData.clickable = true;
            rightArrow.userData.type = 'rightArrow';
            rightArrow.castShadow = true;
            group.add(rightArrow);

            // –°—Ç–≤–æ—Ä—é—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—É –ø–∞–Ω–µ–ª—å
            const infoPanel = new THREE.Group();
            const infoPanelGeometry = new THREE.PlaneGeometry(5, 2);
            const infoPanelMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x2c3e50, 
                transparent: true, 
                opacity: 0.9 
            });
            const infoPanelMesh = new THREE.Mesh(infoPanelGeometry, infoPanelMaterial);
            infoPanelMesh.position.set(0, 0, 0.6);
            infoPanel.add(infoPanelMesh);

            const infoText = new THREE.Mesh(
                new THREE.PlaneGeometry(4.6, 1.6),
                new THREE.MeshStandardMaterial({ 
                    map: createTextTexture('–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç–∏ –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó', 32, '#ffffff', 'transparent'),
                    transparent: true
                })
            );
            infoText.position.set(0, 0, 0.61);
            infoPanel.add(infoText);
            
            infoPanel.visible = false;
            group.add(infoPanel);

            // –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—ñ–≤
            const raycaster = new THREE.Raycaster();
            const mouse = new THREE.Vector2();

            const showInfo = (message, duration = 3000) => {
                const newTexture = createTextTexture(message, 28, '#ffffff', 'transparent');
                infoText.material.map = newTexture;
                infoText.material.needsUpdate = true;
                infoPanel.visible = true;
                
                setTimeout(() => {
                    infoPanel.visible = false;
                }, duration);
            };

            const handleClick = (event) => {
                mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(group.children, true);

                if (intersects.length > 0) {
                    let object = intersects[0].object;
                    
                    // –®—É–∫–∞—î–º–æ –æ–±'—î–∫—Ç –∑ userData.clickable
                    while (object.parent && !object.userData.clickable) {
                        object = object.parent;
                    }

                    if (object.userData && object.userData.clickable) {
                        switch (object.userData.type) {
                            case 'email':
                                showInfo('üìß Email: roman.lyashenko@example.com\n–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ª–∏—Å—Ç–∞');
                                break;
                                
                            case 'web':
                                showInfo('üåê –í–µ–±-—Å–∞–π—Ç: www.lyashenko-dev.com\n–í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —Å–∞–π—Ç...');
                                break;
                                
                            case 'github':
                                showInfo('üíª GitHub: github.com/lyashenko-dev\n–í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó...');
                                break;
                                
                            case 'linkedin':
                                showInfo('üëî LinkedIn: linkedin.com/in/lyashenko-dev\n–í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –ø—Ä–æ—Ñ—ñ–ª—å...');
                                break;
                                
                            case 'avatar':
                                showInfo('üëã –ü—Ä–∏–≤—ñ—Ç! –Ø –õ—è—à–µ–Ω–∫–æ –†–æ–º–∞–Ω\nWeb Developer —Ç–∞ AR Specialist\n–î–æ—Å–≤—ñ–¥: 5+ —Ä–æ–∫—ñ–≤ —É –≤–µ–±-—Ä–æ–∑—Ä–æ–±—Ü—ñ');
                                break;
                                
                            case 'portfolio':
                                const portfolioIndex = object.userData.index;
                                const portfolioMessages = [
                                    '–ü—Ä–æ–µ–∫—Ç 1: –í–µ–±-–¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è–º–∏\n–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó: React, Node.js, MongoDB',
                                    '–ü—Ä–æ–µ–∫—Ç 2: –ú–æ–±—ñ–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è AR –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó\n–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó: React Native, AR.js, Three.js',
                                    '–ü—Ä–æ–µ–∫—Ç 3: E-commerce –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞\n–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó: Vue.js, Express, PostgreSQL'
                                ];
                                showInfo(portfolioMessages[portfolioIndex]);
                                break;
                                
                            case 'leftArrow':
                                group.remove(portfolioItems[currentPortfolio]);
                                currentPortfolio = (currentPortfolio - 1 + portfolioItems.length) % portfolioItems.length;
                                group.add(portfolioItems[currentPortfolio]);
                                showInfo(`–ü—Ä–æ–µ–∫—Ç ${currentPortfolio + 1} –∑ ${portfolioItems.length}`, 1500);
                                break;
                                
                            case 'rightArrow':
                                group.remove(portfolioItems[currentPortfolio]);
                                currentPortfolio = (currentPortfolio + 1) % portfolioItems.length;
                                group.add(portfolioItems[currentPortfolio]);
                                showInfo(`–ü—Ä–æ–µ–∫—Ç ${currentPortfolio + 1} –∑ ${portfolioItems.length}`, 1500);
                                break;
                        }
                    }
                }
            };

            document.addEventListener('click', handleClick);
            document.addEventListener('touchend', handleClick);

            // –ê–Ω—ñ–º–∞—Ü—ñ—ó
            const clock = new THREE.Clock();
            
            await mindarThree.start();
            
            renderer.setAnimationLoop(() => {
                const elapsedTime = clock.getElapsedTime();
                
                // –ê–Ω—ñ–º–∞—Ü—ñ—è –∞–≤–∞—Ç–∞—Ä–∞ (–æ–±–µ—Ä—Ç–∞–Ω–Ω—è)
                avatar.rotation.y = elapsedTime * 0.5;
                avatar.rotation.x = Math.sin(elapsedTime) * 0.1;
                
                // –ê–Ω—ñ–º–∞—Ü—ñ—è —ñ–∫–æ–Ω–æ–∫ (–ø–ª–∞–≤–Ω–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è/–∑–º–µ–Ω—à–µ–Ω–Ω—è)
                const iconScale = 1 + Math.sin(elapsedTime * 2) * 0.1;
                [emailIcon, webIcon, githubIcon, linkedinIcon].forEach(icon => {
                    icon.scale.set(iconScale, iconScale, iconScale);
                });
                
                // –ê–Ω—ñ–º–∞—Ü—ñ—è —Å—Ç—Ä—ñ–ª–æ–∫ (–ø—É–ª—å—Å–∞—Ü—ñ—è)
                const arrowScale = 1 + Math.sin(elapsedTime * 3) * 0.2;
                leftArrow.scale.set(arrowScale, arrowScale, arrowScale);
                rightArrow.scale.set(arrowScale, arrowScale, arrowScale);
                
                // –ê–Ω—ñ–º–∞—Ü—ñ—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–æ–ª—ñ–æ (–ª–µ–≥–∫–µ –∫–æ–ª–∏–≤–∞–Ω–Ω—è)
                if (portfolioItems[currentPortfolio]) {
                    portfolioItems[currentPortfolio].position.y = 0.4 + Math.sin(elapsedTime * 1.5) * 0.1;
                }
                
                renderer.render(scene, camera);
            });
        });
    </script>
</body>
</html>