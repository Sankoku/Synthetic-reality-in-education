<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ3 - AR —Å—Ü–µ–Ω–∞ –∑ —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.1.4/dist/mindar-image-three.prod.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    
    canvas {
      display: block;
    }
    
    #mindar-container {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    
    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px;
      border-radius: 5px;
      z-index: 100;
      font-size: 14px;
      max-width: 300px;
    }
    
    #loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      z-index: 200;
    }
  </style>
</head>
<body>
  <div id="loading">
    <div>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AR...</div>
    <div style="margin-top: 10px; font-size: 12px;">–ù–∞–ø—Ä–∞–≤—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä</div>
  </div>
  
  <div id="info">
    <strong>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ3</strong><br>
    AR —Å—Ü–µ–Ω–∞ –∑ —Ç—Ä—å–æ–º–∞ —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏:<br>
    üì¶ –ö—É–± –∑ avatar.jpg<br>
    üåê –°—Ñ–µ—Ä–∞ –∑ github.png<br>
    üèóÔ∏è –¶–∏–ª—ñ–Ω–¥—Ä –∑ kenny.jpg
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      try {
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è MindAR
        const mindarThree = new window.MINDAR.IMAGE.MindARThree({
          container: document.body,
          imageTargetSrc: "./marker.mind", // –í–∞—à —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –º–∞—Ä–∫–µ—Ä
          maxTrack: 1,
          uiLoading: "no",
          uiScanning: "no"
        });

        const { renderer, scene, camera } = mindarThree;
        
        // –ü—Ä–∏—Ö–æ–≤–∞—Ç–∏ –µ–∫—Ä–∞–Ω –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—ñ—Å–ª—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
        setTimeout(() => {
          document.getElementById('loading').style.display = 'none';
        }, 2000);

        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —è–∫–æ—Ä—è –¥–ª—è –º–∞—Ä–∫–µ—Ä–∞
        const anchor = mindarThree.addAnchor(0);
        
        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä—É–ø–∏ –¥–ª—è –≤—Å—ñ—Ö –æ–±'—î–∫—Ç—ñ–≤
        const objectGroup = new THREE.Group();
        anchor.group.add(objectGroup);

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É—Ä
        const textureLoader = new THREE.TextureLoader();
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É—Ä –∑ –æ–±—Ä–æ–±–∫–æ—é –ø–æ–º–∏–ª–æ–∫
        const avatarTexture = textureLoader.load('./avatar.jpg', 
          () => console.log('Avatar texture loaded'),
          undefined,
          (error) => console.error('Error loading avatar.jpg:', error)
        );
        
        const githubTexture = textureLoader.load('./github.png',
          () => console.log('GitHub texture loaded'),
          undefined,
          (error) => console.error('Error loading github.png:', error)
        );
        
        const kennyTexture = textureLoader.load('./kenny.jpg',
          () => console.log('Kenny texture loaded'),
          undefined,
          (error) => console.error('Error loading kenny.jpg:', error)
        );

        // 1. –ö—É–± –∑ –∞–≤–∞—Ç–∞—Ä–æ–º
        const cubeGeometry = new THREE.BoxGeometry(0.8, 0.8, 0.8);
        const cubeMaterial = new THREE.MeshBasicMaterial({ 
          map: avatarTexture
        });
        const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
        cube.position.set(-1.2, 0, 0); // –ü–æ–∑–∏—Ü—ñ—è –∑–ª—ñ–≤–∞
        objectGroup.add(cube);

        // 2. –°—Ñ–µ—Ä–∞ –∑ GitHub –ª–æ–≥–æ—Ç–∏–ø–æ–º
        const sphereGeometry = new THREE.SphereGeometry(0.5, 32, 32);
        const sphereMaterial = new THREE.MeshBasicMaterial({ 
          map: githubTexture
        });
        const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
        sphere.position.set(0, 0, 0); // –ü–æ–∑–∏—Ü—ñ—è –≤ —Ü–µ–Ω—Ç—Ä—ñ
        objectGroup.add(sphere);

        // 3. –¶–∏–ª—ñ–Ω–¥—Ä –∑ Kenny
        const cylinderGeometry = new THREE.CylinderGeometry(0.3, 0.3, 1.0, 32);
        const cylinderMaterial = new THREE.MeshBasicMaterial({ 
          map: kennyTexture
        });
        const cylinder = new THREE.Mesh(cylinderGeometry, cylinderMaterial);
        cylinder.position.set(1.2, 0, 0); // –ü–æ–∑–∏—Ü—ñ—è —Å–ø—Ä–∞–≤–∞
        objectGroup.add(cylinder);

        // –ú–∞—Å–∏–≤ –æ–±'—î–∫—Ç—ñ–≤ –¥–ª—è –∞–Ω—ñ–º–∞—Ü—ñ—ó
        const animatedObjects = [cube, sphere, cylinder];

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ–≥–æ –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambientLight);

        // –§—É–Ω–∫—Ü—ñ—è –∞–Ω—ñ–º–∞—Ü—ñ—ó
        function animate() {
          const time = Date.now() * 0.001;
          
          // –ê–Ω—ñ–º–∞—Ü—ñ—è –∫—É–±–∞ - –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –Ω–∞–≤–∫–æ–ª–æ –¥–≤–æ—Ö –æ—Å–µ–π
          cube.rotation.x = time * 0.6;
          cube.rotation.y = time * 0.4;
          
          // –ê–Ω—ñ–º–∞—Ü—ñ—è —Å—Ñ–µ—Ä–∏ - –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –ø–æ —Å–∏–Ω—É—Å–æ—ó–¥—ñ –≤–≥–æ—Ä—É-–≤–Ω–∏–∑ —Ç–∞ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
          sphere.position.y = Math.sin(time * 1.5) * 0.3;
          sphere.rotation.y = time * 0.8;
          
          // –ê–Ω—ñ–º–∞—Ü—ñ—è —Ü–∏–ª—ñ–Ω–¥—Ä–∞ - –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è —Ç–∞ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
          const scale = 1 + Math.sin(time * 2) * 0.2;
          cylinder.scale.set(scale, 1, scale);
          cylinder.rotation.y = time * 1.2;
          cylinder.rotation.z = Math.sin(time * 0.8) * 0.1;
          
          // –ü–æ–≤—ñ–ª—å–Ω–µ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –≤—Å—ñ—î—ó –≥—Ä—É–ø–∏ –Ω–∞–≤–∫–æ–ª–æ Y-–æ—Å—ñ
          objectGroup.rotation.y = time * 0.1;
        }

        // –û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –º–∞—Ä–∫–µ—Ä–∞
        anchor.onTargetFound = () => {
          console.log("–ú–∞—Ä–∫–µ—Ä –∑–Ω–∞–π–¥–µ–Ω–æ!");
          document.getElementById('info').style.background = 'rgba(0, 128, 0, 0.7)';
        };

        anchor.onTargetLost = () => {
          console.log("–ú–∞—Ä–∫–µ—Ä –≤—Ç—Ä–∞—á–µ–Ω–æ!");
          document.getElementById('info').style.background = 'rgba(128, 0, 0, 0.7)';
        };

        // –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—ñ–≤ –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
        document.body.addEventListener("click", (e) => {
          const mouseX = (e.clientX / window.innerWidth) * 2 - 1;
          const mouseY = -((e.clientY / window.innerHeight) * 2 - 1);
          const mouse = new THREE.Vector2(mouseX, mouseY);

          const raycaster = new THREE.Raycaster();
          raycaster.setFromCamera(mouse, camera);

          const intersects = raycaster.intersectObjects(animatedObjects);

          if (intersects.length > 0) {
            const clickedObject = intersects[0].object;
            // –î–æ–¥–∞—î–º–æ –µ—Ñ–µ–∫—Ç –ø—Ä–∏ –∫–ª—ñ–∫—É - —à–≤–∏–¥–∫–µ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
            clickedObject.rotation.x += Math.PI / 3;
            clickedObject.rotation.z += Math.PI / 3;
            console.log("–ö–ª—ñ–∫ –ø–æ –æ–±'—î–∫—Ç—É!");
          }
        });

        // –ó–∞–ø—É—Å–∫ AR
        await mindarThree.start();
        
        // –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª—É —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é
        renderer.setAnimationLoop(() => {
          animate();
          renderer.render(scene, camera);
        });

        console.log("AR —Å—Ü–µ–Ω–∞ –∑ —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏ —É—Å–ø—ñ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–∞!");

      } catch (error) {
        console.error("–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó AR:", error);
        document.getElementById('loading').innerHTML = 
          `<div style="color: red;">–ü–æ–º–∏–ª–∫–∞: ${error.message}</div>
           <div style="font-size: 12px; margin-top: 10px;">
           –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ñ–∞–π–ª—ñ–≤ marker.mind, avatar.jpg, github.png, kenny.jpg —Ç–∞ –¥–æ—Å—Ç—É–ø –¥–æ –∫–∞–º–µ—Ä–∏
           </div>`;
      }
    });

    // –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    window.addEventListener('error', (e) => {
      console.error('–ì–ª–æ–±–∞–ª—å–Ω–∞ –ø–æ–º–∏–ª–∫–∞:', e.error);
    });
  </script>
</body>
</html>