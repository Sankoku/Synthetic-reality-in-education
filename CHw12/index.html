<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebXR AR Scene - Three.js Objects</title>
    
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.module.min.js",
            "three/addons/": "https://unpkg.com/three@0.176.0/examples/jsm/"
        }
    }
    </script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #121212;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 100;
            max-width: 300px;
        }
        
        #controls {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 100;
        }
        
        button {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        button:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.05);
        }
        
        #arButton {
            position: fixed !important;
            bottom: 20px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            background: #ff6b35 !important;
            color: white !important;
            border: none !important;
            padding: 15px 30px !important;
            border-radius: 30px !important;
            font-size: 18px !important;
            font-weight: bold !important;
            cursor: pointer !important;
            z-index: 1000 !important;
            transition: all 0.3s ease !important;
        }
        
        #arButton:hover {
            background: #e55a2b !important;
            transform: translateX(-50%) scale(1.05) !important;
        }
    </style>
</head>
<body>
    <div id="info">
        <h3>üéØ WebXR AR –°—Ü–µ–Ω–∞</h3>
        <p>‚Ä¢ –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Enter AR" –¥–ª—è –ø–æ—á–∞—Ç–∫—É</p>
        <p>‚Ä¢ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä –¥–ª—è —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤</p>
        <p>‚Ä¢ –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å —Ç—Ä–∏–≥–µ—Ä –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫—É–±–∞</p>
        <p>‚Ä¢ –û–±'—î–∫—Ç–∏ –∑'—è–≤–ª—è—é—Ç—å—Å—è —É —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–≤—ñ—Ç—ñ</p>
    </div>
    
    <div id="controls">
        <button onclick="clearObjects()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏</button>
        <button onclick="addRandomObject()">üé≤ –í–∏–ø–∞–¥–∫–æ–≤–∏–π –æ–±'—î–∫—Ç</button>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { ARButton } from 'three/addons/webxr/ARButton.js';

        let scene, camera, renderer, controller;
        let objects = [];
        let objectTypes = ['cube', 'sphere', 'pyramid', 'torus'];
        let colors = [0xff6b35, 0x4ecdc4, 0x45b7d1, 0x96ceb4, 0xfeca57, 0xff9ff3, 0x54a0ff];

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        const init = () => {
            // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ü–µ–Ω–∏
            scene = new THREE.Scene();
            
            // –ö–∞–º–µ—Ä–∞
            camera = new THREE.PerspectiveCamera(
                70, 
                window.innerWidth / window.innerHeight, 
                0.01, 
                20
            );

            // –†–µ–Ω–¥–µ—Ä–µ—Ä
            renderer = new THREE.WebGLRenderer({ 
                antialias: true, 
                alpha: true 
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.xr.enabled = true;
            
            document.body.appendChild(renderer.domElement);

            // –û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);

            // –ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä WebXR
            controller = renderer.xr.getController(0);
            scene.add(controller);

            // –í—ñ–∑—É–∞–ª—å–Ω–∏–π —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞
            const geometry = new THREE.CylinderGeometry(0.005, 0.05, 0.1, 6);
            const material = new THREE.MeshBasicMaterial({ color: 0xff6b35 });
            const controllerMesh = new THREE.Mesh(geometry, material);
            controllerMesh.rotateX(-Math.PI / 2);
            controller.add(controllerMesh);

            // –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞
            controller.addEventListener('selectstart', onSelectStart);
            controller.addEventListener('selectend', onSelectEnd);

            // –û–±—Ä–æ–±–Ω–∏–∫–∏ WebXR —Å–µ—Å—ñ–π
            renderer.xr.addEventListener('sessionstart', () => {
                console.log('üöÄ WebXR AR —Å–µ—Å—ñ—é —Ä–æ–∑–ø–æ—á–∞—Ç–æ');
                document.getElementById('info').style.display = 'none';
                document.getElementById('controls').style.display = 'none';
            });
            
            renderer.xr.addEventListener('sessionend', () => {
                console.log('üõë WebXR AR —Å–µ—Å—ñ—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
                document.getElementById('info').style.display = 'block';
                document.getElementById('controls').style.display = 'flex';
            });

            // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è AR –∫–Ω–æ–ø–∫–∏
            const arButton = ARButton.createButton(renderer, {
                optionalFeatures: ['dom-overlay', 'hit-test'],
                domOverlay: { root: document.body }
            });
            arButton.id = 'arButton';
            document.body.appendChild(arButton);

            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö –æ–±'—î–∫—Ç—ñ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó
            addDemoObjects();

            // –ê–Ω—ñ–º–∞—Ü—ñ–π–Ω–∏–π —Ü–∏–∫–ª
            renderer.setAnimationLoop(animate);
        };

        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –æ–±'—î–∫—Ç—ñ–≤
        const createObject = (type, position) => {
            let geometry, material, mesh;
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            switch(type) {
                case 'cube':
                    geometry = new THREE.BoxGeometry(0.08, 0.08, 0.08);
                    break;
                case 'sphere':
                    geometry = new THREE.SphereGeometry(0.05, 16, 16);
                    break;
                case 'pyramid':
                    geometry = new THREE.ConeGeometry(0.05, 0.1, 8);
                    break;
                case 'torus':
                    geometry = new THREE.TorusGeometry(0.04, 0.02, 8, 16);
                    break;
                default:
                    geometry = new THREE.BoxGeometry(0.08, 0.08, 0.08);
            }
            
            material = new THREE.MeshLambertMaterial({ color: color });
            mesh = new THREE.Mesh(geometry, material);
            
            if (position) {
                mesh.position.copy(position);
            }
            
            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –¥–ª—è –∫—Ä–∞—Å–∏
            mesh.userData = {
                rotationSpeed: {
                    x: (Math.random() - 0.5) * 0.02,
                    y: (Math.random() - 0.5) * 0.02,
                    z: (Math.random() - 0.5) * 0.02
                }
            };
            
            scene.add(mesh);
            objects.push(mesh);
            return mesh;
        };

        // –û–±—Ä–æ–±–Ω–∏–∫ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è —Ç—Ä–∏–≥–µ—Ä–∞
        const onSelectStart = () => {
            console.log('üéØ –¢—Ä–∏–≥–µ—Ä –Ω–∞—Ç–∏—Å–Ω—É—Ç–æ');
        };

        const onSelectEnd = () => {
            console.log('üéØ –¢—Ä–∏–≥–µ—Ä –≤—ñ–¥–ø—É—â–µ–Ω–æ - —Å—Ç–≤–æ—Ä—é—î–º–æ –æ–±\'—î–∫—Ç');
            
            // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±'—î–∫—Ç–∞ –Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞
            const position = new THREE.Vector3();
            position.setFromMatrixPosition(controller.matrixWorld);
            
            const objectType = objectTypes[Math.floor(Math.random() * objectTypes.length)];
            createObject(objectType, position);
        };

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ–π–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
        const addDemoObjects = () => {
            // –ö—É–±
            const cube = createObject('cube');
            cube.position.set(0, 0, -1);
            
            // –°—Ñ–µ—Ä–∞
            const sphere = createObject('sphere');
            sphere.position.set(0.3, 0.1, -0.8);
            
            // –ü—ñ—Ä–∞–º—ñ–¥–∞
            const pyramid = createObject('pyramid');
            pyramid.position.set(-0.3, 0.1, -0.8);
            
            // –¢–æ—Ä
            const torus = createObject('torus');
            torus.position.set(0, 0.2, -0.6);
        };

        // –ê–Ω—ñ–º–∞—Ü—ñ–π–Ω–∏–π —Ü–∏–∫–ª
        const animate = () => {
            // –û–±–µ—Ä—Ç–∞–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤
            objects.forEach(obj => {
                if (obj.userData.rotationSpeed) {
                    obj.rotation.x += obj.userData.rotationSpeed.x;
                    obj.rotation.y += obj.userData.rotationSpeed.y;
                    obj.rotation.z += obj.userData.rotationSpeed.z;
                }
            });
            
            renderer.render(scene, camera);
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –∫–Ω–æ–ø–æ–∫
        window.clearObjects = () => {
            objects.forEach(obj => {
                scene.remove(obj);
            });
            objects = [];
            console.log('üóëÔ∏è –í—Å—ñ –æ–±\'—î–∫—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–æ');
        };

        window.addRandomObject = () => {
            const objectType = objectTypes[Math.floor(Math.random() * objectTypes.length)];
            const position = new THREE.Vector3(
                (Math.random() - 0.5) * 2,
                Math.random() * 0.5,
                -Math.random() * 2 - 0.5
            );
            createObject(objectType, position);
            console.log(`üé≤ –î–æ–¥–∞–Ω–æ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π ${objectType}`);
        };

        // –û–±—Ä–æ–±–∫–∞ –∑–º—ñ–Ω–∏ —Ä–æ–∑–º—ñ—Ä—É –≤—ñ–∫–Ω–∞
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ WebXR
        if ('xr' in navigator) {
            console.log('‚úÖ WebXR –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è');
            init();
        } else {
            console.log('‚ùå WebXR –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è —Ü–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º');
            document.getElementById('info').innerHTML = `
                <h3>‚ùå WebXR –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è</h3>
                <p>–î–ª—è —Ä–æ–±–æ—Ç–∏ –∑ AR –ø–æ—Ç—Ä—ñ–±–µ–Ω —Å—É—á–∞—Å–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é WebXR</p>
                <p>–†–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ Chrome –Ω–∞ Android –ø—Ä–∏—Å—Ç—Ä–æ—ó</p>
            `;
        }
    </script>
</body>
</html>